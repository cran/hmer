<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Andy Iskauskas" />

<meta name="date" content="2023-03-29" />

<title>Emulation and History Matching Handbook</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Emulation and History Matching
Handbook</h1>
<h4 class="author">Andy Iskauskas</h4>
<h4 class="date">2023-03-29</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Calibration of models is a complex process and can pose a number of
different hurdles and complications. This document serves to identify a
few common issues, how they would present in usage of the package, and
how best to rectify or circumvent such problems. This is not an
exhaustive list of issues that can arise in emulation and history
matching, but is an attempt to highlight those that occur most
frequently, as well as some behaviours that may seem ‘weird’ when
encountered.</p>
<p>Fundamentally, every model and application thereof is different. The
amount of time spent emulating a model should respect the amount of time
it took to create the model; the emulation can give insights into the
behaviour of the model, any potential issues with how the model behaves
in parts of the parameter space, or highlight implicit structure within
the model. A complex and carefully-constructed model deserves an equally
careful treatment when calibrating it to data.</p>
</div>
<div id="faq" class="section level2">
<h2>FAQ</h2>
<ul>
<li><p>The emulators don’t seem to behave as we’d expect: <a href="#training-suitability">not space-filling?</a> <a href="#model-incompatibility">model behaviour not represented in
runs?</a> <a href="#model-nas">lost points in transition from
model?</a></p></li>
<li><p>The emulators can’t propose any non-implausible points: <a href="#model-discrepancy">not enough model discrepancy?</a> <a href="#output-choice">hard-to-match outputs in early waves?</a></p></li>
<li><p>Both of the above problems: <a href="#output-transformation">is
there a useful transformation of the outputs?</a></p></li>
<li><p>An emulator plot looks odd: <a href="#active-vars">what are the
active variables?</a></p></li>
<li><p>Visualisation of the space is slowing the history match: <a href="#visualisation-choice">can we prioritise sensible
visualisations?</a></p></li>
<li><p>The point proposal is slow: <a href="#proposal-speed">change the
options for point proposal?</a></p></li>
<li><p>The proposed points look to have a strange structure: <a href="#small-spaces">is the target space small or disconnected?</a> <a href="#resampling-consideration">has the sampling omitted a small part
of the space?</a></p></li>
</ul>
</div>
<div id="model-preparation" class="section level2">
<h2>Model preparation</h2>
<div id="training-suitability" class="section level3">
<h3>Training run suitability and specification</h3>
<p>Emulators are statistical surrogates for a complex model and have a
number of strengths (not least, speed comparative to model evaluations),
but fundamentally they only have predictive power relative to the data
they are provided. While in later waves of history matching points
proposed by emulators aim to provide space-filling designs over the
current non-implausible region, the initial points provided by a user
are under no such restrictions. If an initial set of points miss large
regions of the parameter space then the emulators will offer no useful
insight into this region. This is accounted for in the emulator
uncertainties <strong>provided the data is wide-ranging enough to
indicate the variability across the space</strong>. The definition of
‘wide-ranging’ here is nebulous and highly dependent on the nature of
the model, but we give an example below.</p>
<p>Suppose we have a situation where our training runs focus on a subset
of the region. If we expect the emulators to extrapolate to the entire
space, we might not be surprised that the result is sub-optimal. The
most extreme example is if we focus on a subregion where a target is
consistently over- or under-estimated: it is possible to train emulators
that have low uncertainty (due to the consistency of the output) but
simultaneously cannot attain a target value even if we know a match is
possible. We will use the SIR model used in the <code>SIRSample</code>
dataset and similar to illustrate this.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>bad_design <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">aSI =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>),</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">aIR =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">0.1</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">aSR =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>bad_results <span class="ot">&lt;-</span> <span class="fu">get_res</span>(bad_design)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>bad_emulators <span class="ot">&lt;-</span> <span class="fu">emulator_from_data</span>(bad_results, <span class="fu">c</span>(<span class="st">&#39;nS&#39;</span>, <span class="st">&#39;nI&#39;</span>, <span class="st">&#39;nR&#39;</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ranges =</span> <span class="fu">list</span>(<span class="at">aSI =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>), <span class="at">aIR =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">aSR =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting regression surfaces...</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Building correlation structures...</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating emulators...</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing Bayes linear adjustment...</span></span></code></pre></div>
<p>In a circumstance such as this, we may find that the emulator
diagnostics are ‘fine’, albeit with high values of implausibility in the
misclassification diagnostics (the middle column). However, attempts to
generate runs will fail to find points within a respectable
implausibility threshold (prompting additional output from
<code>generate_new_runs</code>), and an aid to identification will be
returned: namely, a set of box plots of the implausibilities for each
output as well as a printed check on the training outputs to see if
there is a consistent over- or under-estimation of one or more
targets.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bad_design_v <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">aSI =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">aIR =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">0.1</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">aSR =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>bad_validation <span class="ot">&lt;-</span> <span class="fu">get_res</span>(bad_design_v)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>invalid <span class="ot">&lt;-</span> <span class="fu">validation_diagnostics</span>(bad_emulators, SIREmulators<span class="sc">$</span>targets, bad_validation)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk bad-design-diagnostic</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>try_generate <span class="ot">&lt;-</span> <span class="fu">generate_new_runs</span>(bad_emulators, <span class="dv">100</span>, SIREmulators<span class="sc">$</span>targets, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Proposing from LHS...</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 initial valid points generated for I=5.324</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing line sampling...</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Line sampling generated 40 more points.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing importance sampling...</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importance sampling generated 72 more points.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 initial valid points generated for I=3.478</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing line sampling...</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Line sampling generated 40 more points.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing importance sampling...</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importance sampling generated 73 more points.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 54 initial valid points generated for I=3</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing line sampling...</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Line sampling generated 40 more points.</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing importance sampling...</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importance sampling generated 8 more points.</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Selecting final points using maximin criterion...</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Resample 1 </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing line sampling...</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Line sampling generated 40 more points.</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing importance sampling...</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importance sampling generated 19 more points.</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Selecting final points using maximin criterion...</span></span></code></pre></div>
<p>If we encounter this problem, it is worth returning to our initial
design and considering whether including additional training points
would be appropriate or whether our initial design was poorly
specified.</p>
<p>Similar issues can arise from errors in specifying parameter ranges
or converting output data from a model not run in R: one should do as
many ‘sanity checks’ as are possible and expeditious to confirm that the
information being provided to emulators is correct.</p>
</div>
<div id="output-choice" class="section level3">
<h3>Output choice</h3>
<p>One of the advantages of the history matching paradigm is that it
finds good regions of parameter space via complementarity: each wave of
history matching removes regions that it can be certain will not fit the
targets under consideration. We can leverage that power by being
judicious about which outputs we match to at each wave. A common
situation for epidemiological models is that, when the full parameter
space is considered, not all outputs of interest are informative (or
even varying at all). Were we to zoom in on a smaller superset of the
good parameter space, these uninformative outputs can contribute in a
meaningful way to the analysis of the space. If we include only the
informative targets at a given wave we can reduce the parameter space so
that subsequent waves of history matching can address the more intricate
outputs. The nature of history matching is that this decision does not
adversely affect the identification of the final good parameter space,
since omission of an output makes the restrictions on the
non-implausible space for a wave less stringent.</p>
<p>The converse of the above is that including uninformative outputs can
bias the results of a history match by falsely suggesting constancy of
outputs that in fact vary only in small regions of parameter space. For
example, consider a simple SIR model with no vital dynamics where we
wish to match to the number of infected and deceased people at some
number of time points. Suppose the observed data we are matching to
indicates a very high number of deaths despite a relatively low infected
population, suggesting that the parameter controlling the transition
<span class="math inline">\(I \to D\)</span> is extremely high. For an
initial set of (space-filling) runs, we may find that this interplay
means that all of our parameter sets give rise to very few, or no,
deaths. Were we to include all outputs we may come to the conclusion
that a match cannot be attained, since none of our model runs suggest
that a high number of deaths is achievable. If we instead spend a few
waves matching to the number of infected people before including the
deaths, the later waves will be able to more easily identify the regions
of interest.</p>
</div>
<div id="model-discrepancy" class="section level3">
<h3>Model Discrepancy</h3>
<p>Even the most complex model is unlikely to perfectly replicate the
intricacies of the real-world system it reflects, and observational data
is equally difficult to obtain with perfect clarity. While the desire to
obtain ‘perfect matches’ from the model with respect to data is natural,
it should be tempered by an understanding of the constraints and
shortfalls of modelling reality. Even in deterministic models small
choices like the numerical method by which differential equations are
solved, or machine precision, can give rise to different outcomes.</p>
<p>Emulators accept a variety of sources of uncertainty and incorporate
those into the framework of history matching. They automatically
encapsulate the uncertainty in their own construction and approximation
of the model, but do not automatically make judgements about the
validity of model runs or suitability of targets to match to. If these
uncertainties are not taken into account, it is entirely possible that
the region of parameter space that would correspond to the real-world
situation is overlooked in history matching.</p>
<p>When using emulation, it is helpful to consider the following,
non-exhaustive, checklist:</p>
<ul>
<li><p>Do the bounds of the targets accurately reflect the uncertainty
in the observational process? Features like systematic bias from
under-counting or under-reporting, or additional uncertainty coming from
the use of composite measures (for example, the ratio of two
observations where each has an uncertainty attached to it) should be
carefully considered and represented in the targets provided to the
emulators.</p></li>
<li><p>Are our judgements about any fixed parameters in the model
reasonable? It is common to have complex models where we identify a
subset of the inputs as influential on the model output, and fix the
remainder at sensible values. One way to account for this fixing of
variables is to do a sensitivity analysis on the model with respect to
those fixed parameters. A simple approach is, for each fixed parameter,
to consider small perturbations around its fixed value (while holding
all other parameters fixed) and analyse the effect on the model output.
The combination of the variability in all fixed parameters gives an
estimate of the <strong>internal discrepancy</strong> in the model for
each output.</p></li>
<li><p>Are there any parts of the model itself which we could augment or
change to better reflect the reality it models? If, given the time and
computational resource, we could improve the model to produce results
that are closer to reality, then we cannot ignore the deficiency the
model suffers without those changes. A common case occurs in agent-based
models, where it is seldom possible to simulate every person in a
country (or even region of a country): quantifying this discrepancy can
be done by considering the model for different numbers of agents and
looking at the change in output. This collection of uncertainties,
termed <strong>external discrepancy</strong>, is often hard to quantify
rigorously: this does not mean that they should be swept aside.</p></li>
</ul>
<p>All of these quantities can be offered to the emulators. The target
uncertainty is the most straightforward, arising naturally from the
provision of targets to the emulators; the internal and external
discrepancies can be provided to <code>emulator_from_data</code> as a
list of lists, where each element corresponds to an output and contains
named elements <code>internal</code> and <code>external</code>.</p>
<p>It may seem counterproductive to make the emulators ‘more uncertain’
(especially when doing so leads to ‘good’ points that do not provide
perfect fits to the data), but the inclusion of discrepancy is
fundamental to producing an accurate representation of the parameter
space of interest.</p>
<p>The variety of visualisation tools in the <code>hmer</code> package
can give an insight, where complete matches to data were not possible,
as to the potential structure of the discrepancy. Given a output that we
require to be within the region <span class="math inline">\([a,
b]\)</span>, if via <code>wave_values</code> we see that the best points
proposed by history matching can get no closer to its target than <span class="math inline">\(b+0.1\)</span> (say), then this does not
necessarily mean that the target cannot be attained. It could be that
there is a hitherto unconsidered reason that the targets we have set are
too stringent or it could be that slight modification of one of the
fixed values in the model, or an aspect of the model itself, could
account for the excess in the output. Discrepancy analysis should not be
seen as a barrier to matching reality but as an opportunity to gain a
deeper understanding of the physical process and the pitfalls in
modelling it.</p>
</div>
<div id="model-incompatibility" class="section level3">
<h3>Model Incompatibility</h3>
<p>The emulators are most powerful when they act as interpolators over
the region of interest - by which we mean the region where we expect the
model to be adequate in fitting to the observed data (given the
uncertainties mentioned above). If the points on which the emulators are
trained do not give rise to anything approaching a fit to data, even
univariately, then we may not be surprised if this results in emulators
that do not believe a match can be found.</p>
<p>As an example, we consider the dataset provided in
<code>problem_data</code>; this consists of training data from a model
consisting of 21 inputs and 19 outputs. Along with this are the defined
targets and ranges, as well as an ‘extra’ set of points which includes
the best found fit for the model using hand-fitting. It will be
important to note that, aside from outputs 13, 14, 16, and 17, all
outputs are proportions or ratios (taking values within <span class="math inline">\([0,1]\)</span>). The central feature of this model
is that acceptable matches lie in a ‘trench’ at in a small corner of the
space, for which many of the inputs are at, or close to, their minimum
values.</p>
<p>We try to train a set of emulators to this dataset in the normal
fashion. The one change is that we use the <code>targets</code> argument
of <code>emulator_from_data</code> in order to gain an insight into the
structure of the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>problem_ems <span class="ot">&lt;-</span> <span class="fu">emulator_from_data</span>(problem_data<span class="sc">$</span>data, <span class="fu">names</span>(problem_data<span class="sc">$</span>targets), problem_data<span class="sc">$</span>ranges, <span class="at">targets =</span> problem_data<span class="sc">$</span>targets, <span class="at">more_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target output5 consistently overestimated.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target output7 consistently overestimated.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target output9 consistently overestimated.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target output10 consistently overestimated.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target output15 consistently overestimated.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target output18 consistently overestimated.</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Some outputs may not be adequately emulated, due to consistent over/underestimation in training data.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Consider looking at the outputs (using, eg, behaviour_plot); some outputs may require extra runs and/or transformation.</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in emulator_from_data(problem_data$data, names(problem_data$targets), : Fewer than 210 non-NA</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; points in 21 dimensions - treat the emulated outputs with caution, or include more training points</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (minimum 10 times the number of input parameters).</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting regression surfaces...</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Building correlation structures...</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating emulators...</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing Bayes linear adjustment...</span></span></code></pre></div>
<p>There are a few things of interest here, but we will focus on the
first few printed statements. They indicate that some of the outputs to
match to are consistently over-estimated - this in and of itself is not
guaranteed to be a problem, but it always warrants further study. We can
look at the behaviour of one of the identified outputs from the model
perspective using a simple plot command.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> problem_data<span class="sc">$</span>data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>ranges)[<span class="dv">9</span>]], <span class="at">y =</span> problem_data<span class="sc">$</span>data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>targets)[<span class="dv">7</span>]],</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlim =</span> problem_data<span class="sc">$</span>ranges[[<span class="dv">9</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;Parameter&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Output&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> problem_data<span class="sc">$</span>targets[[<span class="dv">7</span>]], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk check-output</p>
</div>
<p>As suggested, we may also use <code>behaviour_plot</code> to look at
the emulator predictions. This can replicate the above behaviour if
given the points and no emulators, but we want to look at the emulator
behaviour here.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">behaviour_plot</span>(<span class="at">ems =</span> <span class="fu">list</span>(problem_ems[[<span class="dv">7</span>]]), <span class="at">targets =</span> problem_data<span class="sc">$</span>targets)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk behaviour-plot" /><img src="data:image/png;base64,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" alt="plot of chunk behaviour-plot" /></p>
<p>We can see that, for some inputs we begin to see an indication of the
‘trench’ behaviour to the left-hand side of the input values. However,
it does not truly see the steep drop-off and it is nowhere near the
target, predicting a range of output7 of approximately <span class="math inline">\([0.7, 1]\)</span>.</p>
<p>The target is some distance away from any of the points used to train
it, and in fact the data we have available to train the emulators is
fairly consistent across the chosen input. One can play around with
different inputs or other problematic outputs and find that this issue
is commonplace.</p>
<p>This data is used in two ways by the emulator: first to set up vague
prior statements about the global structure of the space and the
correlation between neighbouring points, and second to perform the Bayes
linear adjustment relative to this data. If the data suggests that the
output is more or less constant across the input space, and a long way
away from the target, then we should not be surprised if the emulator is
moderately certain that a match to the data cannot be found.</p>
<p>One solution to this issue is to omit an output of this type from the
particular wave of emulation (as mentioned earlier), but this may mask
the true problem. It is always worthwhile investigating targets flagged
by <code>emulator_from_data</code> in order to understand the task we
are asking the emulators to do. Perhaps it becomes clear that, at least
for wide ranges, this target is unsuitable for emulation; there is
another thing that we can consider doing, detailed below.</p>
</div>
<div id="output-transformation" class="section level3">
<h3>Output Transformations</h3>
<p>The above problem has its roots in the nature of the model. We may
conclude that this output is very unlikely to be matched, but remember
that we only use a (comparatively) small number of points to train the
emulators. If there are interesting and relevant behaviours in a very
small part of the parameter space, it is entirely possible that we have
simply missed them. In this example, we know the answer: let us include
the ‘extra’ points in the above plot:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(problem_data<span class="sc">$</span>data, problem_data<span class="sc">$</span>extra)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> plot_data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>ranges)[<span class="dv">9</span>]], <span class="at">y =</span> plot_data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>targets)[<span class="dv">7</span>]],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlim =</span> problem_data<span class="sc">$</span>ranges[[<span class="dv">9</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;Parameter&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Output&quot;</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;black&#39;</span>, <span class="fu">nrow</span>(problem_data<span class="sc">$</span>data)), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, <span class="fu">nrow</span>(problem_data<span class="sc">$</span>extra))))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> problem_data<span class="sc">$</span>targets[[<span class="dv">7</span>]], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAb1BMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6kNtmAABmADpmAGZmOgBmOpBmtv+QOgCQOjqQZgCQkGaQtpCQ29uQ2/+2ZgC2///bkDrb25Db////tmb/25D//7b//9v///+dQBXFAAAACXBIWXMAAAsSAAALEgHS3X78AAAOGElEQVR4nO2dCXubOhpGSTPT5PY2ae8kncWJp97+/2+8Bi+IXSCBPvs953lak4A+hA5akCFkB5AkS50BSAPiRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRQkRn4FlZhQfkBbmBvGiIF4UxIuCeFGCxW+fizHil88JaSEdoeL372/F5+br79FpISGh4nc/PyufY9JCQqjxogT38btX+vhbRGRU3zdFeV5X+Si3vyxdf19ZKH6obFzOhpablCGy5h7LH5zNruuzyuqssq7c3XUatraHyrR57agHCqx/deS0tdy5BeMeYYvHZsrs4BRF5cCr27ZOY5dlVfm55+uHZhl3bVDbsr6ybR/1X/p9D9KINcaOtzxncNe+Iw+qqSoF03Vk7rb1QB2bV7cdKryB9Z0bNiMfGgvlD26htQU3LD5G2kr+qgXTeWiVNu/SGHRvfaiJ9ylAL7o9N37RJn4g+DTxzTD+dmYQX89BZU2Zv67ctxWAZwVwktR22V1mnqdGSwX3ausP9TO3Pfih/nPXud2xfE3mbTa++PLYO9ZlteW2gqgdW0/BNTrP6q7bS9NZPtRy4GStVqC19eVvD84uqxHqpdLMdrUWuIlqy40DavR/9bLuXOOzekJa57haV9WOxt24sbp2kHXcHTbCu3txN6mvcxayy1ixvr62o55GrRPnCFvOn7LQPOK0Fldzw4E4Qzs6X8a3XciPE187oesl0XoktVUXiR0F3yreyZMPfVv6R+kPXz/fRmfQWe7ZcCDO4J727y/j0lbrmPPbrJbpcruuM7i1kLr32ll6ccRPqeht4Ts6Qf8AflsGrc7Z/VhNSFs/wl7xlV/VgwzncHjLxsrwU2QSLaUwIYDflkGrR6etq60NjWqjrpYEneEqP7ZtOKYMuzeP5b0lzqVRmtLCOzEsim9TXR3+VrZtSd6/w0u4kLZhyubjaT+Jh9s4n8CeGwatHpe2tY77dmgeR3QX4gfauHg5CFo9Lm2zA2s9sNbf+pRBPPEjW/T+rT2PsS2LM55+y4uv/aYlnZ/4vr7Aq1SHonnTH7zz7I6Zhdbd9q8fSB6y69GZ6bjUO69puf4bkZlB733X54OxR4ufm+EzfSB9yL5Hbewo9+rj45ZnT7ThHSG+N21vRk75HFNG9eGCbyKPaN6r/Hafwrsh8UNFO1b8lNFvfx7GJ7KMmT6+u/yyq/iplSOC+P5U47NkHkPiA/Y0q/j7xEAfH0FHcB+vh4VRvRUdVvKxCBbERyLU28wdgbHT6n7EB3ubV7y18UUK8fOUQEDJZpdvRxDvuXpS2ulF4DEHNDFs/Xux+CB+ehEMJAyp8LGdtAScxfv0oHckfjLx4y5VvUO6t6DV09KGNsnBgWJlqC8g4iPS9G6q2yxB/KzYFb/YRftN9fHRMCx+RiId8y2LtzYZtgixzvabFq8I4kVBvCr08ffHkmMWxNth0asUa+IVB+oXlMVrXpqfkRcvq164j8+0zS+IMfHiVX5BrIkX7+aXw5546YH9chgUD0uAeFEQLwriRUH8/JgcrdoTb7KYQrB5fWpOvM1iCsHmESF+dmweEeLnx+QBmRNvs5juj6XFo9UIC4u/w4b8RkG8KEnFcxKkI2UfT/VPSMpRPeITgnhRkl7HC3g3e4jB4rfP2dO67X2DfDt3sNyohYrf/1od1k9H/99/j04rwP2Kz98bv36pvD/eO60A9yueGt+PVe9R+vgX+vjbw963c7AIycWbbQvvnFjincHd5cFHr7R2Rz93Tuoaj/hEIF6UGKP6nMmjerynIfg6/v2t+Nx85Tr+pogxc+d+jkkLCaHGixLcx+9ew/p4SMPyo3pGc1USlcfi4rl+q5KqPBCfGMSLIiOePr6GSh8PNkC8KIgXJbF4OvxUpBXPED8ZiBcF8aLQx4vCqF4UxItiTjyN/zJYE5/sOwu18w3xKXebEMSn3G1CrIlP1OYiftzq2dIujpp3xKuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIsSLH77/LZ/z7Lma+fqaeX+5oRtQsXnLxz8eDv6/z7wwkG9vzJjm1Dxu5+f+18rj1eMIt4WwU39sbpvXg6HzdNAWsTbInxw91EobXqnjzcNo3pREC9KLPHO4C67MD1XMDvUeFEQL0qEmbuiWf/SuIxHvGlizNzlbJpztoNpHx8fhzaBuYgwc1f5HJH28RHz6UhY4xGfkuA+fvc6tY9HfEpSjurxnhAu50RJJT6v7dT4hCQS/3ghID6EgHhREC8KfbwojOpF8RJ/mo9tmZUNCQ1J8RB/nptrvXd+cmia+sSMqPHRQj86TIgLMUjQxz8i3gB+Nb7zi5gpoRFvgRE1fv0SJ/TVOd4TMkJ8tFE9wg0wQvwmUlMPFhjTx79FDU3NT0qKmbtz/87gLiWLi398ZFRvAT/x+d+8aHsgdnzoR8TbwEv8/j2/kluPNO8jflxEiMfSX9JwDW8Ev6a+qOxRajzGjTDmcm7kpC2Xc5bhck6UxW/EYHRng0VvxKhfyyE+HUveiIF3QyzZx7vCkZ6YJW/EoJobYtEbMZBuhxQ3YoABUtyIQR9vgMVvxGBIb4NFZ+64lrNDoss5xKfGv6kf2cNzHW8bH/Gbh9WhePlMYGhquiE8xBevHjm0vnZmZGik28HnS5ruP14ZEhqSsmiNBzss2ccX0M3bYMlRPZM3hkh1HR8QF2KAeFFS3YgBiVl6rj4gHsSEv3MnCuJFQbwoKZ6PD4gJsUhyI0ZAUIhEksu5gKAQCcSLEkf89lvLRD43YlgmVHzPo/NM4FgmuMbvXo/K/Wo8GCJCU797/fp/xN8aUfr47XPbl/WItwwzd6Lw7ZwoscQ7t+BmF+rbcC1niMUncAICQkQQL0qw+O1z159JoY+3TKj4/fvpbvtN82+hMaq3TPCUbffzVYi3DDVelAhz9f59PNiBmTtREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVZTDzfxdtiKfHcfWMMxIuCeFHo40WZU/z53no+LX5yOScK4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCjccyf6SY0XBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KMHit8/Zw4r3zt0coeLz987t318Qf2uEij8J/3hC/I0Ro8YfWf/jG+JviuA+fvf6kn+sm6+aRLxlGNWLgnhRYol3BnfZhem5gtmhxouCeFFizNzl8P74GyPSdfxh8/X36LSQkDgzd8zV3xzUeFEizNzRx98ijOpFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEixIsnleM3iah4nnh4I0SKp5XjN4o1HhRgvt4XjF6mzCqFwXxosQS7wzusgvTcwWzQ40XBfGiMHMnCtfxojBzJwo1XhRm7kRhVC8K4kVBvCiIFwXxoiBelDnFg2XmEz9fqLjBzGYsZTDEiwZDvGgwxIsGQ7xoMMSLBkO8aDAmYURBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCgRxO9es/NTNuVShGD5w5pvkWKVDwRFCLZ/zx5WsYIdj7LlUZWRbL991sIOEy4+L9L1U3UpQrDdj9Vh+0dIAVeysw48iZxgH29tz5NNC5Yf5Tq0smzO586o8g8Xnz9NeTrlyqUIwTb5EXyE2HKzs/3zr8DWo3KUgZTBtt9/Bwf8ePjv6ShHlX+4+CLvP1aVpQjBcsKCObH2v/4X2NS7R/nv0Ka+DBalxl9sjyr/cPF5s3faXbkUIdghb7peIsVav4T28WWw7fNbUcRxchZhWHQVP6r8Ddf43WuQ92rGQsXPdJT5KGYTPLpLU+Nn6uOLmhUpY+viPvOg08g5yn8Fi3dGMuGN5OEqfuE+Pm+QL6P6l/BR/SVEsPdqdkJrvBPsI7ipd44yZo0fVf7RruPznUe7jj8GO9XSIFtlxqJdx5+PMlRVGWyTBU8KnMSPLX9m7kRBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxomiJP7010+8+68Abxa0jJj6X6XkfO+LviEJmfqf16Rns7Z9/ffk8Le5//efYFGyK5qC4f7r877RZ6qzHRlD89o9V8Qz2t8/8oY3z4v796Xg2PBVbfBTPJThLwc92GERM/HP5lMbu5+f1Dwr8/Nz/Wh3yf8fzID8VTivLpZSZngcx8VeFH/lLU08/Fouu+Pydqg+rXPx1KWWm50FT/O71rWjqi8eOikVX/OkPFeTir0sJ8zwTmuKLh83+WF2eOTsuOuLznn3z9fe5jz8v3R2a4vMHp//511vx42nRFX9s4R+OP70Xo/qHFTUe7gjEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi/I3AZcaC4KULq0AAAAASUVORK5CYII=" alt />
<p class="caption">plot of chunk check-output-extra</p>
</div>
<p>In fact, in a small part of the parameter space (somewhere near what
turns out to be a 10d ‘corner’ of the space) this target comes much
closer to being attained. The behaviour of the output is very
interesting: in the vast majority of the input space it settles
consistently at high values. As we get close to this corner, it steeply
drops off into the trench where the acceptable matches can be found. It
is not reasonable, therefore, to just dismiss these outputs out of hand:
they do in fact contain useful information about the structure of the
space.</p>
<p>One way to potentially elicit this information is to consider a
transformation of the outputs. The relevant transformation depends on
the nature of the data: here, given that the output values are between 0
and 1, we might consider a <code>logit</code> transformation. Care must
be taken with this transformation, including the fact that the logit
transformation acts on <span class="math inline">\((0,1)\)</span> and
not <span class="math inline">\([0,1]\)</span>; here however we simply
outline a sketch of the solution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>logit_data_first <span class="ot">&lt;-</span> problem_data<span class="sc">$</span>data</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>logit_data_second <span class="ot">&lt;-</span> problem_data<span class="sc">$</span>extra</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>logit_data_first<span class="sc">$</span>output7 <span class="ot">&lt;-</span> <span class="fu">log</span>(logit_data_first<span class="sc">$</span>output7<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>logit_data_first<span class="sc">$</span>output7))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>logit_data_second<span class="sc">$</span>output7 <span class="ot">&lt;-</span> <span class="fu">log</span>(logit_data_second<span class="sc">$</span>output7<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>logit_data_second<span class="sc">$</span>output7))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>logit_data_first <span class="ot">&lt;-</span> logit_data_first[<span class="fu">is.finite</span>(logit_data_first<span class="sc">$</span>output7),]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>logit_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(logit_data_first, logit_data_second)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> logit_data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>ranges)[<span class="dv">9</span>]], <span class="at">y =</span> logit_data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>targets)[<span class="dv">7</span>]],</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlim =</span> problem_data<span class="sc">$</span>ranges[[<span class="dv">9</span>]], <span class="at">ylim =</span> <span class="fu">range</span>(logit_data[,<span class="fu">names</span>(problem_data<span class="sc">$</span>targets)[<span class="dv">7</span>]]), <span class="at">xlab =</span> <span class="st">&quot;Parameter&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Output&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;black&#39;</span>, <span class="fu">nrow</span>(logit_data_first)), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, <span class="fu">nrow</span>(logit_data_second))))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">log</span>(problem_data<span class="sc">$</span>targets[[<span class="dv">7</span>]]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>problem_data<span class="sc">$</span>targets[[<span class="dv">7</span>]])), <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk logit-example</p>
</div>
<p>This transformation has pulled the original data and the ‘corner’
data closer together, but more importantly it has helped to distinguish
what appeared to be very similar behaviour of the original data.
Training an emulator to this transformed data stands a better chance of
giving us a sensible result, with an appropriate estimation of the
uncertainty. Indeed, we can see this by comparing an emulator trained to
the original data and one trained to the transformed data. The slice we
choose is along the two parameters that are identically 0 in the ‘best
fit’ point, with all other parameters set to their ‘best fit’
values.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(problem_ems[[<span class="dv">7</span>]], <span class="at">plot_type =</span> <span class="st">&#39;imp&#39;</span>, <span class="at">params =</span> <span class="fu">c</span>(<span class="st">&#39;input9&#39;</span>, <span class="st">&#39;input15&#39;</span>), <span class="at">fixed_vals =</span> problem_data<span class="sc">$</span>extra[<span class="dv">1</span>,(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">15</span>)]], <span class="at">targets =</span> problem_data<span class="sc">$</span>targets)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk problem-imp</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>new_emulator <span class="ot">&lt;-</span> <span class="fu">emulator_from_data</span>(logit_data_first, <span class="fu">c</span>(<span class="st">&#39;output7&#39;</span>), problem_data<span class="sc">$</span>ranges)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in emulator_from_data(logit_data_first, c(&quot;output7&quot;), problem_data$ranges): Fewer than 210 non-NA</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; points in 21 dimensions - treat the emulated outputs with caution, or include more training points</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (minimum 10 times the number of input parameters).</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting regression surfaces...</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Building correlation structures...</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Creating emulators...</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Performing Bayes linear adjustment...</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_emulator<span class="sc">$</span>output7, <span class="at">plot_type =</span> <span class="st">&#39;imp&#39;</span>, <span class="at">params =</span> <span class="fu">c</span>(<span class="st">&#39;input9&#39;</span>, <span class="st">&#39;input15&#39;</span>), <span class="at">fixed_vals =</span> logit_data_second[<span class="dv">1</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">15</span>)]], <span class="at">targets =</span> <span class="fu">list</span>(<span class="at">output7 =</span> <span class="fu">log</span>(problem_data<span class="sc">$</span>targets<span class="sc">$</span>output7<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>problem_data<span class="sc">$</span>targets<span class="sc">$</span>output7))))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk transformed-imp</p>
</div>
<p>We can see a marked difference in the implausibility, and checking
the print statements from the two emulators will show a big difference
in the level of uncertainty: the transformed emulator is more uncertain
simply because it is being exposed to a wider range of behaviour. Note
that we did not train the transformed emulator on our ‘extra’ points:
this emulator had no greater knowledge about the space than the original
emulator.</p>
<p>Any transformation used must be considered carefully (potentially
with recourse to any previously trained emulators). There is no
algorithmic solution to this sort of problem: it is not the case that we
simply perform the same transformation to any ratio output, nor that the
transformation does not introduce other strange behaviour. It is up to
the judgement of the user to explore the best way to represent the
changing behaviour of the model across parameter space.</p>
</div>
<div id="model-nas" class="section level3">
<h3>Model NAs</h3>
<p>Some models can return non-numeric output values, particularly where
the model could give rise to non-physical results and is terminated
early. This is a good approach to error handling in model evaluation,
but can cause false inference when training emulators.</p>
<p>The rough rule of thumb for training emulators is that we require “a
number of training points equal to ten times the number of parameters”.
However, this should not be taken as an absolute: this is the minimal
number of points required for it to be even possible that we can infer
anything from emulator diagnostics or, indeed, the emulators themselves.
For most situations, this rule holds true and if we have a validation
set of points aside from these, then we can be fairly confident in how
the emulators are performing; however, one should consider carefully
whether a model has sufficiently complex behaviour that we should
increase the number of runs.</p>
<p>The <code>emulator_from_data</code> call of the above ‘problem’ model
flagged one additional thing while training: namely that there were
fewer than <span class="math inline">\(10d\)</span> points available for
training. This happened both in the original and the transformed case:
in the former case a few model runs were lost due to NAs existing in
some of their outputs; in the latter case it was exacerbated by the
removal of some output values that were exactly 0 or 1 before
transformation, resulting in a non-finite output in the transformed
data. In both cases, we can rectify this at the model evaluation stage:
if one suspects that some training points will be lost to problems with
NA values or at the transformation stage, then we should create an
initial design containing more points than the <span class="math inline">\(10d\)</span> threshold. Providing slightly more
points to the emulators is not deleterious to either performance or
speed, while providing fewer can be very problematic. Generally, an
additional <span class="math inline">\(10\%\)</span> of points should
suffice, but this should be tailored to the behaviour of the model
itself.</p>
</div>
</div>
<div id="final-note-on-model-related-concerns" class="section level2">
<h2>Final Note on Model-related Concerns</h2>
<p>Many of the problems detailed above are only common at early waves;
especially when the parameter space is large. Once one or two waves of
carefully trained emulators have ruled out the most egregious parts of
parameter space, the stability of the model results and of the structure
of the output space is greatly increased. When performing history
matching, it is always worth carefully considering the first few waves
of the match - not just from the point of view of obtaining acceptable
matches to data, but also to gain an understanding about the structure
of the model that we are trying to match to.</p>
</div>
<div id="emulator-visualisation" class="section level2">
<h2>Emulator Visualisation</h2>
<div id="active-vars" class="section level3">
<h3>Emulator Plots and Active Variables</h3>
<p>There are a variety of functions in the package to visualise the
behaviour of the model and of the emulated surface. Some of these
require some careful consideration, and one such instance is the
<code>emulator_plot</code> function. This provides a contour plot of an
emulated output on a particular two-dimensional slice of the input
parameter space, and can be helpful in identifying the large-scale
behaviour and response of an output. However, the structure of the
emulators can suggest strange behaviours if we choose an uninformative
slice (or call the function with its default behaviour).</p>
<p>As an example, consider again the <code>problem_data</code> dataset.
We can easily obtain the specifications of the emulator corresponding to
(transformed) output7, and find that it has a set of ‘active variables’:
namely inputs 1, 8, 9, and 15, which we can see using the
<code>plot_actives</code> command.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_actives</span>(new_emulator)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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IQzgl55aNlGSueHn9QN+mallEyUBHnjguw3fXAK8bGrZREm8Tj/q524EHnjg9YlENz93I/DAA69PJLr5uRuBBx54fSLRzc/dCDzwwOsTiW5+7kbggQden0h083M3Ag888PpEopufuxF44IHXJxLd/NyNwAMPvD6R6ObnbgQeeOD1iUQ3P3cj8MADr08kuvm5G4EHHnh9ItHNz90IPPDA6xOJbn7uRuCBB16fSHTzczcCDzzw+kSim5+7EXjggdcnEt383I3AAw+8PpHo5uduBB544PWJRDc/dyPwwAOvTyS6+bkbgQceeH0i0c3P3Qg88MDrE4lufu5G4IEHXp9IdPNzNwIPPPD6RKKbn7sReOCB1ycS3fzcjcADD7w+kejm524EHnjg9YlENz93I/DAA69PJLr5uRuBBx54fSLRzc/dCDzwwOsTiW5+7kbggQden0h083M3Ag888PpEopufuxF44IHXJxLd/NyNwAMPvD6R6ObnbgQeeOD1iUQ3P3cj8MADr08kuvm5G4EHHnh9ItHNz90IPPDA6xOJbn7uRuCBB16fSHTzczcCDzzw+kSim5+7EXjggdcnEt383I3AAw+8PpHo5uduBB544PWJRDc/dyPwwAOvTyS6+bkbgQceeH0i0c3P3Qg88MDrE4lufu5G4IEHXp9IdPNzNwIPPPD6RKKbn7sReOCB1ycS3fzcjcADD7w+kejm524EHnjg9YlENz93I/DAA69PJLr5uRuBBx54fSLRzc/dCDzwwOsTiW5+7kbggQden0h083M3Ag888PpEopufuxF44IHXJxLd/NyNwAMPvD6R6ObnbgQeeOD1iUQ3P3cj8MADr08kuvm5G4EHHnh9ItHNz90IPPDA6xOJbn7uRuCBB16fSHTzczcCDzzw+kSim5+7EXjggdcnEt383I3AAw+8PpHo5uduBB544PWJRDc/dyPwwAOvTyS6+bkbgQceeH0i0c3P3Qg88MDrE4lufu5G4IEHXp9IdPNzNwIPPPD6RKKbn7sReOCB1ycS3fzcjcADD7w+kejm524EHnjg9YlENz93I/DAA69PJLr5uRuBBx54fSLRzc/dSFaaSHTzW/or/NA80jywspL1zRxzcmEBvkUlwOtKgK8CfItKgNeVAF8F+BaVAK8rAb4K8C0qAV5XAnwV4FtUAryuBPgqwLeoBHhdCfBVgG9RCfC6EuCrAN+iEuB1JcBXAb5FJcDrSoCvAnyLSoDXlQBfBfgWlQCvKwG+CvAtKgFeVwJ8FeBbVAK8rgT4KsC3qAR4XQnwVYBvUQnwuhLgqwDfohLgdSXAVwG+RSU3C57cyADf0QDf0QDf0QDf0awL/vxwTRP7csNOd47Ew7/e3z8cvf/y5cTA/T/t7z+/PH73dL/IR1cV7569yQd//tXEF3lQVF315E3Td33+Zb+vlYzePql/2dELm2imWePZpqebnm1yuunZpqfrOdvALAl/LeLo9f3/fjl5P50/qN23b588ry+hvOS7l5Ml+cC/vqr1vHv2fe1esi9bJ3v/5zej8+fF/BOnMqp9Wc/ZJqebnG16usnZpqfbfLbXnG5gll7xL57Xj+383/7yVy9rA/W7cvTi/r9r8E8P63dlfq+cP7f7ZvKr5HdEbd1NwRclb39ff/hMz+w626nTTc42Pd3kbNPTnedsk9MNjOBSfz//C5xP/J3P84H3X9T/Cm+f1C9pr/cf1ErsOjh5NZ1YGpct05f682J1vDicLGm+1M9zttOnO322yemmZ5uerudsA8OuvqNZGr54cNevT8lI84Cq5EYl2WdeMxKXZeHL69P9NzNGmgdEJel+PN3ctack2WdeMxKYkBXfMNI8oCpJNkfpbqk1Jck+85qRwCwP/3T6O45kpHlAVXKjkuwzrxmJS8jm7t3vGkeaB1Ql5NqEwKf7j2SkeUBRsr5tpWjPG5eYS/2DmSPNA6KStW0rVXvewGz29/Hr21aK9rxxWR7+fL/++tk1I80DopL1bStFe964LH+p/+1L+zljpHlAVWKDa9tWiva8MVkavth71K9IyUjzgKpkPDh7oE0lc/TEJGZzt+iLVCt9eWwd20rVnjcum725Iz+a5eFfJPuPZKR5QFWytm2las8bls1+rX5920rRnjcuIZu7hpH17p3Ws60U7Xnjstlv0rToXdeYPW9c2Nx1NMt+yvbZf6ZWWTLSPKAqGa1zWyna84Zls1d8i16I37zX6tucFr0k16ZX7YpsNnyL3oHZuDdpyM3MJsOvb1sp2vNGZpPhyYwA39EA39EA39EA39FsKPzgdpbd6s2uGX56tpqTaWU2FX73bNTfng1b1HQ3Gwyf/zzNsp3R4IOPt07Gt7IPj7K9UT8/ujjKts/6lwXrPuNVZ4Ph+9uvds+Gj08Gd3rFcXmr+LGbj4+OD/KxQXnjTsOTwiZmU+HL5/j8t1s9u6SPb9mPv2d59vKb/fGNdZ/v6rOp8GbZ3zoZPjL4y1sl/E5V09+5Ku5YNht+Z9QvV/zlLfvx6k7v4sgu9eMb6z7f1Wej4YcPs588NNfLW+UP29MNH443d8CTzgT4jgb4jgb4jgb4jgb4jgb4jub/SP1umeRtAoYAAAAASUVORK5CYII=" alt />
<p class="caption">plot of chunk plot-active</p>
</div>
<p>We know that at a training point, the emulator should exactly
replicate the output value and that the uncertainty at this point is 0,
so let us plot this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_emulator<span class="sc">$</span>output7, <span class="at">params =</span> <span class="fu">c</span>(<span class="st">&#39;input1&#39;</span>, <span class="st">&#39;input8&#39;</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fixed_vals =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)]]) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">y =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">8</span>])</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk output-active-1</p>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_emulator<span class="sc">$</span>output7, <span class="at">plot_type =</span> <span class="st">&#39;sd&#39;</span>, <span class="at">params =</span> <span class="fu">c</span>(<span class="st">&#39;input1&#39;</span>, <span class="st">&#39;input8&#39;</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fixed_vals =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)]]) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">y =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">8</span>])</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk output-active-1</p>
</div>
<p>Now, let’s do the same with inputs 2 and 3:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_emulator<span class="sc">$</span>output7, <span class="at">params =</span> <span class="fu">c</span>(<span class="st">&#39;input2&#39;</span>, <span class="st">&#39;input3&#39;</span>),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fixed_vals =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)]]) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">2</span>], <span class="at">y =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">3</span>])</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk output-active-2</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_emulator<span class="sc">$</span>output7, <span class="at">plot_type =</span> <span class="st">&#39;sd&#39;</span>, <span class="at">params =</span> <span class="fu">c</span>(<span class="st">&#39;input2&#39;</span>, <span class="st">&#39;input3&#39;</span>),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fixed_vals =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]]) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">2</span>], <span class="at">y =</span> problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">3</span>])</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk output-active-2</p>
</div>
<p>The expectation surface appears to be completely flat across the
surface, as does the standard deviation. What’s going wrong here?</p>
<p>The answer is that nothing is going wrong. The way that the emulator
determines correlation, which in turn determines the structure of the
Bayes linear update, is by recourse to active variables. Recall that the
structure of the correlator is</p>
<p><span class="math display">\[\text{Cov}[u(x), u(x^{\prime})] =
(1-\delta)\sigma^2c(x_A,x_A^{\prime}) + \delta \sigma^2
I_{x=x^{\prime}}\]</span></p>
<p>for some correlation function <span class="math inline">\(c(x,
x^{\prime})\)</span> - the <span class="math inline">\(A\)</span>
subscript indicates that we are only considering the active variables in
the correlation function. The active variables, in turn, are defined as
those parameters that contribute meaningfully to the global structure of
the space; i.e. the regression surface. Let’s consider taking a slice
across parameter space in two of the non-active directions. The
regression surface does not change across this slice by definition; the
correlation between any training point and any point on this slice is
identical, as all points on the slice have an identical value of the
active variables. Thus the Bayes linear update uniformly modifies their
expectation and variance by an identical amount, giving rise to the
above ‘constant’ plots. This is the pitfall of using lower-dimensional
slices of a high-dimensional parameter space to try to gain an intuition
into the full space.</p>
<p>But if a training point is included in the slice (as we did above),
shouldn’t we expect at least some variation? Shouldn’t there be a single
point in the standard deviation plot where it is zero? The answer is
yes, but it is almost impossible to pick this up in the plot. The nature
of the correlation structure is that there is a discontinuous jump akin
to a Dirac delta when <span class="math inline">\(x=x^{\prime}\)</span>
(due to the <span class="math inline">\(I_{x=x^{\prime}}\)</span> term),
so that at a single point the variance drops to identically zero. When
creating the contour plots, this cannot be accommodated. We can see this
clearly by creating a one-dimensional plot across one of the non-active
variables:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="fu">length</span>(problem_data<span class="sc">$</span>ranges), <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(problem_data<span class="sc">$</span>ranges)) dm[,i] <span class="ot">&lt;-</span> <span class="fu">rep</span>(problem_data<span class="sc">$</span>data[<span class="dv">1</span>,i], <span class="dv">1000</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>dm[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(problem_data<span class="sc">$</span>data[<span class="dv">1</span>,<span class="dv">2</span>], <span class="fu">seq</span>(problem_data<span class="sc">$</span>ranges[[<span class="dv">2</span>]][<span class="dv">1</span>], problem_data<span class="sc">$</span>ranges[[<span class="dv">2</span>]][<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">999</span>)))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>data1d <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">data.frame</span>(dm), <span class="fu">names</span>(problem_data<span class="sc">$</span>ranges))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> new_emulator<span class="sc">$</span>output7<span class="sc">$</span><span class="fu">get_cov</span>(data1d)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> data1d<span class="sc">$</span>input2, <span class="at">y =</span> vars, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">xlab =</span> <span class="st">&quot;input2&quot;</span>, <span class="at">ylab =</span> <span class="st">&#39;Variance&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk dirac-delta</p>
</div>
<p>Such ‘constant’ plots should not be a concern - they represent the
actual behaviour of the emulator on the slice in question.</p>
</div>
<div id="visualisation-choice" class="section level3">
<h3>Choice of Visualisation</h3>
<p>The <code>hmer</code> package has a multitude of functions that allow
us to visualise the emulator behaviour and that of the model. On a
wave-by-wave basis, however, it is not necessarily useful or expedient
to consider all of them. Here, we detail the main visualisations in
roughly increasing order of computational time and their most
appropriate use. Not included here are the diagnostic plots
(particularly <code>validation_diagnostics</code>) - these should be
performed at every wave of the history matching process to ensure the
quality of the trained emulators.</p>
<ul>
<li><p>Emulator Specification plots (<code>plot_actives(...)</code>,
<code>behaviour_plot(...)</code>, <code>effect_strength(...)</code>):
plots which focus on an aspect of the emulator structure. These are fast
and give an insight into the global behaviour of the emulator: for
example, which parameters are dominating the structure of the
non-implausible space. They by no means give an exhaustive description
of the emulators or of the model space, but are useful as ‘sanity
checks’ or exploratory analyses.</p></li>
<li><p>Emulator plots (<code>emulator_plot(...)</code>,
<code>plot(em, ...)</code>): shows behaviour on a 2-dimensional slice of
parameter space for expectation, variance, standard deviation,
implausibility, or maximum implausibility. Comparatively fast and useful
for looking at interesting aspects of the emulated surface (for example,
looking at how an output is affected by two important variables). The
caveat is that we are only ever looking at a 2d slice of the space, and
forgetting this can lead to dangerous conclusions.</p></li>
<li><p>Multiwave and model output plots
(<code>wave_&lt;aspect&gt;(...)</code>,
<code>simulator_plot(...)</code>): these are useful for visualising the
progress of a history match and, in some cases, the reasons why we are
unlikely to find a match to data and potential solutions. Their speed
depends on the number of waves and at later points in the history match
it can be useful to remove early waves where the structure of the
non-implausible space is vague. The <code>wave_numbers</code> argument
is often the means by which this is achieved.</p></li>
<li><p>Projected and aggregated plots (<code>plot_lattice(...)</code>,
<code>space_removed(...)</code>): projects the full space into a
collection of lower-dimensional subspaces, giving representations of
implausibility and/or optical depth. These plots give a more in-depth
representation of the implausibility structure of the entire space and
of suitable implausibility cutoffs at a given wave without resorting to
slices. The downside is the increased computational time - the number of
evaluations can be controlled by the <code>maxpoints</code> (for
<code>plot_lattice</code>) or <code>ppd</code> (for
<code>space_removed</code>) argument. Higher values of these give a
fuller description of the space at greater computational cost.</p></li>
</ul>
<p>As a general rule of thumb, at each wave visualisations from the
first two categories can be useful to gain an insight into the model
behaviour, along with <code>space_removed</code> (with a value of
<code>ppd</code> appropriate to the complexity of the space) for a
heuristic justification for a given implausibility cut. Visualisations
such as <code>wave_values</code> and <code>plot_lattice</code> are
typically useful for providing a final determination about the structure
of the non-implausible space rather than performing them at each
wave.</p>
</div>
</div>
<div id="proposing-points" class="section level2">
<h2>Proposing Points</h2>
<div id="proposal-speed" class="section level3">
<h3>Proposal Speed</h3>
<p>The major advantage of emulation is that predictions at unseen points
can be performed in a fraction of the time that the equivalent model
evaluations would take. This feature is taken advantage of when we
propose points by evaluating large numbers of points across the space in
order to find the most informative parameter sets for model evaluation.
Of course, it can seem (especially at higher waves, when multiple
emulators are being used per output) that the proposal stage is slower
than ideal.</p>
<p>Something to bear in mind in this circumstance is that the
comparisons made are sensible. If we wish to generate <span class="math inline">\(100\)</span> points, the point generation stage
will typically test between <span class="math inline">\(2000\)</span>
and <span class="math inline">\(10000\)</span> points depending on the
shape and size of the non-implausible region. One should therefore
compare performance of the model not against the time taken to run <span class="math inline">\(100\)</span> simulations but that required to run
<span class="math inline">\(2000\)</span> simulations.</p>
<p>One thing that can be helpful to speed the process, or at least
utilise model run time efficiently, is to have point generation produce
far more points than are required for emulator training. This can be
done in tandem with the <code>to_file</code> argument to
<code>generate_new_runs</code> so that proposed points are periodically
saved outside of the current R session. Once a sufficient number of
points have been proposed for the purposes of training, the model runs
can be started while the emulators continue to propose points.</p>
<p>While counter-intuitive, this can be advantageous at later waves. If
we have a large collection of points proposed at wave <span class="math inline">\(n\)</span>, then we can check the validity of
those points at wave <span class="math inline">\(n+1\)</span> simply by
checking their implausibility with respect to <strong>only the new
emulators</strong>. This removes the need for the point proposal to
generate a large space-filling design only to reject most of it, and for
many models the space reduction is modest (certainly rarely reducing the
space to less than <span class="math inline">\(&lt;1\%\)</span> of its
previous size) over adjacent waves, allowing us to immediately produce a
new design for the next wave.</p>
<p>This approach can be achieved by using the <code>plausible_set</code>
argument in <code>generate_new_runs</code>: if a plausible set is
provided then it will be used as a starting point for generation of more
points using the line sampling and slice/importance sampling
methodology. The process of creating more points at the wave will be
faster than it would be if it had to explore the current non-implausible
space with no prior information.</p>
</div>
<div id="small-spaces" class="section level3">
<h3>Small Spaces and Disconnected Regions</h3>
<p>The default methods for exploring parameter space are relatively
robust in generating space-filling parameter sets that represent the
geometric structure of the non-implausible region. However, there are a
few circumstances where these ‘vanilla’ methods fail to find points or,
if they find them, fail to accurately represent the space.</p>
<ul>
<li><p>Very small regions: if for some reason (potentially because of
the addition of new outputs at a wave) the space reduction between waves
is extreme, then it may be hard to find even a single point with
adequate implausibility. The vanilla methods handle this by relaxing the
implausibility and proposing sets of points sequentially (as
demonstrated in the earlier SIR example), but this may fail for
extremely small non-implausible regions.</p></li>
<li><p>Disconnected regions: in general, the vanilla methods have no
preference for connected non-implausible regions and, if we have points
in each of the disconnected ‘blobs’, then a space-filling design will be
produced. However, this becomes more difficult if the relative sizes of
the blobs is large. For instance, if we have two regions where the
second region is far smaller than the first, it may be the case that we
do not succeed in seeding points in the second region. In this case it
is extremely unlikely that we will be able to represent the smaller
region in our final design.</p></li>
</ul>
<p>A variety of options are available to deal with this. As mentioned,
the automatic relaxation of implausibility during point generation will
handle the majority of these cases, but in the more egregious cases we
may wish to change how we identify points. For very small regions, we
can consider derivative emulation and perform ‘emulated gradient
descent’ on our least-worst points; the function
<code>directional_proposal</code> allows for us to try to find
directions in parameter space that will improve the output values. For
disconnected regions with a severe size differential, we may use IDEMC
point generation using the <code>idemc</code> function: this uses a
similar implausibility relaxation approach but extends this with an
evolutionary algorithm to fill out the regions at each level, and is
much more robust when dealing with disconnected regions. IDEMC can also
be used in the event where we suspect we have a very small
non-implausible space - the reason it is not used by default is that it
is computationally far more intensive than the methods used in
<code>generate_new_runs</code>. Whether or not it will be advantageous
to use these advanced methods is in the hands of the user, and our
beliefs about the structure of the non-implausible space (if indeed it
exists).</p>
</div>
<div id="resampling-consideration" class="section level3">
<h3>The Resample and Oversample Argument</h3>
<p>By its nature, the selection of points in
<code>generate_new_runs</code> is random. The default behaviour for
generating new points is as follows:</p>
<ul>
<li>Generate a large, random, Latin hypercube and reject implausible
points;</li>
<li>Take semi-random pairs of the remaining points and sample along the
line connecting them to find boundaries of the non-implausible
space;</li>
<li>Use the generated points as a prior for a mixture distribution to
employ importance sampling;</li>
<li>Apply a maximin argument to find the subset of points that is most
‘space-filling’.</li>
</ul>
<p>Each of these steps employs an element of randomness, and running
<code>generate_new_runs</code> multiple times will generate different
representatives of the non-implausible space. In general, the scheme for
proposing points will give consistent non-implausible regions over
multiple iterations, and the points therein suitable for training new
emulators (or, at later stages, defining a uniform span of the
non-implausible region). However, in situations where the structure of
the non-implausible region is non-trivial and where we ask for
comparatively few points, the stochastic nature of the procedure can
omit useful points. This often comes from the ‘large’ Latin hypercube
design, where it can be difficult to fully represent the non-implausible
space and hence make it harder for later stages to cover those parts of
parameter space.</p>
<p>The success of the proposal stage should be judged by expert
elicitation, often with recourse to the <code>plot_wrap</code> function
to determine whether the proposal looks sensible. If we suspect that the
aforementioned difficulty is arising, and do not wish to resort to more
intensive strategies such as IDEMC, then we can try two things.</p>
<p>If we suspect that there are small parts of parameter space being
missed, then we can demand that the Latin hypercube generates more
points before rejecting. The argument <code>points.factor</code> can be
passed to the <code>generate_new_runs</code> function call, which
determines what multiple of the required points we test. For instance, a
call of the form</p>
<p><code>generate_new_runs(ems, 100, targets, points.factor = 60)</code></p>
<p>will create a Latin hypercube of <span class="math inline">\(100\times60 = 6000\)</span> points to check
implausibility against. The higher the value of
<code>points.factor</code>, the more likely we are to find a
representative set of points in the complex non-implausible region. Of
course, the higher the value of <code>points.factor</code>, the more
emulator evaluations are required, and the longer the proposal
takes.</p>
<p>If we feel that the structure of the space has been identified, but
that small parts of the space are under-represented (for example a thin
‘bridge’ between two blobs), we can demand that the point generation
performs additional resampling of the space after the first stage. A
resampling step consists of thinning the current set of points and
performing all point proposal methods aside from the initial LHD, giving
the proposal an opportunity to explore the boundaries and neighbourhoods
thereof more carefully. This is controlled by the <code>resample</code>
argument, which by default is set to 1. Higher values will perform this
resampling step multiple times. This can be helpful in later waves or
early waves with a complex non-implausible structure, but again comes at
a computational cost.</p>
<p>Proposing points is an art as much as a science, and it can be
valuable to consider this step carefully, resampling or oversampling as
necessary. The points provided to train the emulators have a large
impact on the ultimate quality of the emulators, and at later stages
have a large impact on the quality of the inference we can make about
the structure of the ‘fitting’ space of the model. Dependent on the
nature of the model, a more hands-on, slower, and considerate approach
can save multiple waves of history matching compared to the default.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
